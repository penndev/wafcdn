import{b as R,e as S,g as M,h as P}from"./video-cce15425.js";import{r as h,f as i,o as $,c as N,a as s,g as e,w as t,j as u,t as m,F as G,v as H,E as _}from"./index-24c808f8.js";import"./request-7e928fa4.js";const j=s("br",null,null,-1),I=s("br",null,null,-1),L=s("br",null,null,-1),Q=s("br",null,null,-1),J=s("br",null,null,-1),K=s("br",null,null,-1),O=s("br",null,null,-1),W={style:{"white-space":"pre-wrap"}},X=s("br",null,null,-1),Y={class:"dialog-footer"},te={__name:"transcode",setup(Z){const d=h({total:0,query:{limit:20,page:1,order:null,name:null},data:[]}),V=n=>{d.value.query.name=null,d.value.query.order=null,c()},k=n=>{d.value.query.page=n,c()},C=n=>{d.value.query.limit=n,c()},x=({column:n,prop:o,order:f})=>{let r="";f==="descending"?r="-":f==="ascending"&&(r="+"),d.value.query.order=r+o,c()},c=()=>{R(d.value.query).then(n=>{d.value.data=n.data,d.value.total=n.total})},w=h(null),a=h({visible:!1,title:"dialog",form:{},formRule:{name:[{required:!0,message:"名称",trigger:"blur"},{min:2,message:"用户名最少为2个字符",trigger:"blur"}],format:[{required:!0,message:"转码格式",trigger:"blur"},{min:2,message:"转码格式最少为2个字符",trigger:"blur"}],vcodec:[{required:!0,message:"视频编码器",trigger:"blur"},{min:2,message:"编码器最少为2个字符",trigger:"blur"}],acodec:[{required:!0,message:"音频编码器",trigger:"blur"},{min:2,message:"编码器最少为2个字符",trigger:"blur"}]},formAction:"add"}),U=()=>{a.value.title="新增编码器",a.value.visible=!0,a.value.formAction="add",a.value.form={}},q=n=>{a.value.title="创建数据",a.value.visible=!0,a.value.formAction="edit",a.value.form=n},A=n=>{H.confirm(`请仔细确认是否删除数据[${n}]?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{S({id:n}).then(o=>{_.warning(o)})})},T=()=>{w.value.validate(n=>{n?a.value.formAction==="add"?M(a.value.form).then(o=>{a.value.visible=!1,_.success(o),c()}):a.value.formAction==="edit"?(P(a.value.form).then(o=>{a.value.visible=!1,_.info(o),c()}),a.value.visible=!1):_.warning("提交错误"):_.error("请输入正确的数据！")})};return c(),(n,o)=>{const f=i("el-input"),r=i("el-form-item"),b=i("el-button"),y=i("el-form"),p=i("el-table-column"),v=i("el-link"),D=i("el-table"),E=i("el-pagination"),F=i("el-main"),g=i("el-input-number"),z=i("el-dialog");return $(),N(G,null,[s("div",null,[e(y,{inline:!0},{default:t(()=>[e(r,{label:"名称"},{default:t(()=>[e(f,{modelValue:d.value.query.name,"onUpdate:modelValue":o[0]||(o[0]=l=>d.value.query.name=l),placeholder:"名称",clearable:""},null,8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[e(b,{type:"primary",icon:"search",onClick:c},{default:t(()=>[u(" 查询 ")]),_:1}),e(b,{type:"info",icon:"Refresh",onClick:V},{default:t(()=>[u(" 重置 ")]),_:1})]),_:1})]),_:1})]),e(F,{style:{"background-color":"#fff"}},{default:t(()=>[e(b,{type:"primary",icon:"Plus",onClick:U},{default:t(()=>[u(" 新增 ")]),_:1}),e(D,{data:d.value.data,style:{width:"100%"},onSortChange:x},{default:t(()=>[e(p,{fixed:"",prop:"id",label:"ID",width:"80",sortable:"custom"}),e(p,{prop:"name",label:"编码名称",width:"140"}),e(p,{prop:"format",label:"编码格式",width:"140"}),e(p,{label:"视频配置",width:"160"},{default:t(l=>[e(v,{class:"ea-tag",type:"primary"},{default:t(()=>[u(" 编码器: "+m(l.row.vcodec),1)]),_:2},1024),j,e(v,{class:"ea-tag",type:"success"},{default:t(()=>[u(" 帧率: "+m(l.row.vfps>0?l.row.vfps:"默认"),1)]),_:2},1024),I,e(v,{class:"ea-tag",type:"info"},{default:t(()=>[u(" 分辨率: "+m(l.row.vwidth>0?l.row.vwidth:"适应")+"×"+m(l.row.vheight>0?l.row.vheight:"适应"),1)]),_:2},1024),L,e(v,{class:"ea-tag",type:"warning"},{default:t(()=>[u(" 码率/kbps: "+m(l.row.vbitrate>0?l.row.vbitrate:"默认"),1)]),_:2},1024),Q,e(v,{class:"ea-tag",type:"danger"},{default:t(()=>[u(" 质量: "+m(l.row.vcrf>0?l.row.vcrf:"默认"),1)]),_:2},1024)]),_:1}),e(p,{prop:"acodec",label:"音频配置",width:"160"},{default:t(l=>[e(v,{class:"ea-tag",type:"primary"},{default:t(()=>[u(" 编码器: "+m(l.row.acodec),1)]),_:2},1024),J,e(v,{class:"ea-tag",type:"success"},{default:t(()=>[u(" 采样率/Hz: "+m(l.row.asamplerate>0?l.row.asamplerate:"适应"),1)]),_:2},1024),K,e(v,{class:"ea-tag",type:"info"},{default:t(()=>[u(" 比特率/kbps: "+m(l.row.abitrate>0?l.row.abitrate:"默认"),1)]),_:2},1024),O,e(v,{class:"ea-tag",type:"warning"},{default:t(()=>[u(" 声道: "+m(l.row.achannel>0?l.row.achannel:"默认"),1)]),_:2},1024)]),_:1}),e(p,{prop:"command",label:"附加配置",width:"180"},{default:t(l=>[s("span",W,m(l.row.command),1)]),_:1}),e(p,{prop:"updatedAt",label:"最近更新",width:"200"}),e(p,{prop:"createdAt",label:"创建日期",width:"200"}),e(p,{fixed:"right",label:"操作",width:"120"},{default:t(l=>[e(b,{link:"",type:"primary",onClick:B=>q(l.row)},{default:t(()=>[u(" 编辑 ")]),_:2},1032,["onClick"]),e(b,{link:"",type:"danger",onClick:B=>A(l.row.id)},{default:t(()=>[u(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),X,e(E,{background:"",layout:"total, sizes, prev, pager, next",total:d.value.total,"page-size":d.value.query.limit,onCurrentChange:k,onSizeChange:C},null,8,["total","page-size"])]),_:1}),e(z,{modelValue:a.value.visible,"onUpdate:modelValue":o[15]||(o[15]=l=>a.value.visible=l),title:a.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:t(()=>[s("span",Y,[e(b,{onClick:o[14]||(o[14]=l=>a.value.visible=!1)},{default:t(()=>[u("取消")]),_:1}),e(b,{type:"primary",onClick:T},{default:t(()=>[u("确定")]),_:1})])]),default:t(()=>[e(y,{ref_key:"dialogRef",ref:w,"label-position":"left",model:a.value.form,rules:a.value.formRule},{default:t(()=>[e(r,{label:"编码名称",prop:"name"},{default:t(()=>[e(f,{modelValue:a.value.form.name,"onUpdate:modelValue":o[1]||(o[1]=l=>a.value.form.name=l)},null,8,["modelValue"])]),_:1}),e(r,{label:"编码格式",prop:"format"},{default:t(()=>[e(f,{modelValue:a.value.form.format,"onUpdate:modelValue":o[2]||(o[2]=l=>a.value.form.format=l),placeholder:"文件后缀 m3u8 mpd mp4 等"},null,8,["modelValue"])]),_:1}),e(r,{label:"视频编码器",prop:"vcodec"},{default:t(()=>[e(f,{modelValue:a.value.form.vcodec,"onUpdate:modelValue":o[3]||(o[3]=l=>a.value.form.vcodec=l),placeholder:"ffmpeg -encoders 查看支持的编码器"},null,8,["modelValue"])]),_:1}),e(r,{label:"视频宽",prop:"vwidth"},{default:t(()=>[e(g,{modelValue:a.value.form.vwidth,"onUpdate:modelValue":o[4]||(o[4]=l=>a.value.form.vwidth=l),min:0,max:7680,"controls-position":"right",placeholder:"“0”或者“空”为源文件宽 或根据高自适应",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(r,{label:"视频高",prop:"vheight"},{default:t(()=>[e(g,{modelValue:a.value.form.vheight,"onUpdate:modelValue":o[5]||(o[5]=l=>a.value.form.vheight=l),min:0,max:4320,"controls-position":"right",placeholder:"“0”或者“空”为源文件高 或根据宽自适应",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(r,{label:"质量控制",prop:"vcrf"},{default:t(()=>[e(g,{modelValue:a.value.form.vcrf,"onUpdate:modelValue":o[6]||(o[6]=l=>a.value.form.vcrf=l),min:0,max:51,"controls-position":"right",placeholder:"数值越小，视频质量越高 默认为23",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(r,{label:"视频帧率",prop:"vfps"},{default:t(()=>[e(g,{modelValue:a.value.form.vfps,"onUpdate:modelValue":o[7]||(o[7]=l=>a.value.form.vfps=l),min:0,max:60,"controls-position":"right",placeholder:"“0”或者“空”为源文件帧率",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(r,{label:"视频码率",prop:"vbitrate"},{default:t(()=>[e(g,{modelValue:a.value.form.vbitrate,"onUpdate:modelValue":o[8]||(o[8]=l=>a.value.form.vbitrate=l),min:0,"controls-position":"right",placeholder:"kbps 不输入则使用ffmpeg内置码率",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(r,{label:"音频编码器",prop:"acodec"},{default:t(()=>[e(f,{modelValue:a.value.form.acodec,"onUpdate:modelValue":o[9]||(o[9]=l=>a.value.form.acodec=l),placeholder:"ffmpeg -encoders 查看支持的编码器"},null,8,["modelValue"])]),_:1}),e(r,{label:"音频比特率",prop:"abitrate"},{default:t(()=>[e(g,{modelValue:a.value.form.abitrate,"onUpdate:modelValue":o[10]||(o[10]=l=>a.value.form.abitrate=l),min:0,max:1e3,placeholder:"kbps 不输入则使用ffmpeg内置码率","controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(r,{label:"音频采样率",prop:"asamplerate"},{default:t(()=>[e(g,{modelValue:a.value.form.asamplerate,"onUpdate:modelValue":o[11]||(o[11]=l=>a.value.form.asamplerate=l),min:0,placeholder:"(44100  48000)Hz 不输入则使用ffmpeg内置采样率","controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(r,{label:"音频通道",prop:"achannel"},{default:t(()=>[e(g,{modelValue:a.value.form.achannel,"onUpdate:modelValue":o[12]||(o[12]=l=>a.value.form.achannel=l),min:0,max:8,placeholder:"不输入则使用ffmpeg内置采样率","controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(r,{label:"FFMPEG参数",prop:"command"},{default:t(()=>[e(f,{modelValue:a.value.form.command,"onUpdate:modelValue":o[13]||(o[13]=l=>a.value.form.command=l),rows:"3",type:"textarea",placeholder:"FFMPEG自定义的参数 按行分割"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{te as default};
