import{g as Q,d as G,p as H,a as J}from"./rolepermission-13c97a51.js";import{r as k,f as i,o as v,c as g,a as _,g as l,w as t,F as h,j as r,s as V,v as K,E as b,h as q,t as C}from"./index-271749e0.js";import"./request-7a9563c7.js";const O=_("br",null,null,-1),W=_("small",null,"输入前端开发中的路由名称用英文逗号分割！例 `Dashboard,SystemAdministrator | *` ",-1),X=_("br",null,null,-1),Y=_("small",null,"输入后端开发预留的全路径部分接口地址！例 `/admin/add | *` ",-1),Z={class:"dialog-footer"},oe={__name:"permission",setup(ee){const u=k({total:0,query:{limit:20,page:1,order:null,email:null},data:[]}),D=()=>{u.value.query.email=null,m()},A=n=>{u.value.query.page=n,m()},U=n=>{u.value.query.limit=n,m()},B=({column:n,prop:o,order:f})=>{let s="";f==="descending"?s="-":f==="ascending"&&(s="+"),u.value.query.order=s+o,m()},m=()=>{Q(u.value.query).then(n=>{u.value.data=n.data,u.value.total=n.total})},w=k(null),e=k({visible:!1,title:"dialog",form:{},formRule:{name:[{required:!0,message:"管理员名称",trigger:"blur"},{min:2,message:"名称最少为2个字符",trigger:"blur"}]},formAction:"add",tempvalue:null}),z=n=>{e.value.form.route.splice(n,1)},E=()=>{e.value.form.route||(e.value.form.route=[]),e.value.form.route.push({path:e.value.tempvalue}),e.value.tempvalue=""},T=()=>{e.value.title="创建数据",e.value.visible=!0,e.value.formAction="add",e.value.form={}},$=n=>{e.value.title="创建数据",e.value.visible=!0,e.value.formAction="edit",e.value.form=n},F=n=>{K.confirm("请仔细确认是否删除?","警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{G({id:n}).then(o=>{b.warning(o),m()})})},N=()=>{w.value.validate(n=>{n?e.value.formAction==="add"?H(e.value.form).then(o=>{e.value.visible=!1,b.info(o),m()}):e.value.formAction==="edit"?(J(e.value.form).then(o=>{e.value.visible=!1,b.info(o),m()}),e.value.visible=!1):b.info("提交错误"):b.error("请输入正确的数据！")})};return m(),(n,o)=>{const f=i("el-input"),s=i("el-form-item"),p=i("el-button"),x=i("el-form"),c=i("el-table-column"),R=i("el-switch"),S=i("el-tag"),P=i("el-table"),L=i("el-pagination"),M=i("el-main"),j=i("el-link"),I=i("el-dialog");return v(),g(h,null,[_("div",null,[l(x,{inline:!0},{default:t(()=>[l(s,{label:"角色名称"},{default:t(()=>[l(f,{modelValue:u.value.query.email,"onUpdate:modelValue":o[0]||(o[0]=a=>u.value.query.email=a),placeholder:"角色名称",clearable:""},null,8,["modelValue"])]),_:1}),l(s,null,{default:t(()=>[l(p,{type:"primary",icon:"search",onClick:m},{default:t(()=>[r(" 查询 ")]),_:1}),l(p,{type:"info",icon:"Refresh",onClick:D},{default:t(()=>[r(" 重置 ")]),_:1})]),_:1})]),_:1})]),l(M,{style:{"background-color":"#fff"}},{default:t(()=>[l(p,{type:"primary",icon:"Plus",onClick:T},{default:t(()=>[r(" 新建角色 ")]),_:1}),l(P,{data:u.value.data,style:{width:"100%"},onSortChange:B},{default:t(()=>[l(c,{prop:"id",label:"ID",width:"80",sortable:"custom"}),l(c,{prop:"name",label:"名称",width:"150"}),l(c,{prop:"status",label:"状态",width:"120"},{default:t(a=>[l(R,{modelValue:a.row.status,"onUpdate:modelValue":d=>a.row.status=d,"active-value":1,"inactive-value":0,size:"large","inline-prompt":"","active-text":"启用","inactive-text":"禁用",disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(c,{prop:"menu",label:"菜单组"},{default:t(a=>[(v(!0),g(h,null,V(a.row.menu.split(","),(d,y)=>(v(),q(S,{key:y,style:{margin:"1px"}},{default:t(()=>[r(C(d),1)]),_:2},1024))),128))]),_:1}),l(c,{prop:"route",label:"路由组"},{default:t(a=>[(v(!0),g(h,null,V(a.row.route,(d,y)=>(v(),q(S,{key:y,type:"success",style:{margin:"1px"}},{default:t(()=>[r(C(d.path),1)]),_:2},1024))),128))]),_:1}),l(c,{prop:"createdAt",label:"创建日期",width:"200"}),l(c,{fixed:"right",label:"操作",width:"120"},{default:t(a=>[l(p,{link:"",type:"primary",onClick:d=>$(a.row)},{default:t(()=>[r(" 编辑 ")]),_:2},1032,["onClick"]),l(p,{link:"",type:"danger",onClick:d=>F(a.row.id)},{default:t(()=>[r(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),O,l(L,{background:"",layout:"total, sizes, prev, pager, next",total:u.value.total,"default-page-size":u.value.query.limit,onCurrentChange:A,onSizeChange:U},null,8,["total","default-page-size"])]),_:1}),l(I,{modelValue:e.value.visible,"onUpdate:modelValue":o[6]||(o[6]=a=>e.value.visible=a),title:e.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:t(()=>[_("span",Z,[l(p,{onClick:o[5]||(o[5]=a=>e.value.visible=!1)},{default:t(()=>[r("取消")]),_:1}),l(p,{type:"primary",onClick:N},{default:t(()=>[r("确定")]),_:1})])]),default:t(()=>[l(x,{ref_key:"dialogRef",ref:w,model:e.value.form,rules:e.value.formRule},{default:t(()=>[l(s,{label:"名称",prop:"name"},{default:t(()=>[l(f,{modelValue:e.value.form.name,"onUpdate:modelValue":o[1]||(o[1]=a=>e.value.form.name=a)},null,8,["modelValue"])]),_:1}),l(s,{label:"状态",prop:"status"},{default:t(()=>[l(R,{modelValue:e.value.form.status,"onUpdate:modelValue":o[2]||(o[2]=a=>e.value.form.status=a),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),l(s,{label:"菜单",prop:"menu"},{default:t(()=>[l(f,{modelValue:e.value.form.menu,"onUpdate:modelValue":o[3]||(o[3]=a=>e.value.form.menu=a)},null,8,["modelValue"]),W]),_:1}),X,l(s,{label:"路由组",prop:"route"},{default:t(()=>[(v(!0),g(h,null,V(e.value.form.route,(a,d)=>(v(),g("div",{key:d,style:{"margin-bottom":"8px",width:"100%"}},[l(j,{type:"info"},{default:t(()=>[r(" 路由-> "+C(a.path),1)]),_:2},1024),r("   "),l(p,{size:"small",type:"info",icon:"Delete",circle:"",onClick:y=>z(d)},null,8,["onClick"])]))),128)),l(f,{modelValue:e.value.tempvalue,"onUpdate:modelValue":o[4]||(o[4]=a=>e.value.tempvalue=a)},{append:t(()=>[l(p,{icon:"Plus",onClick:E})]),_:1},8,["modelValue"]),Y]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{oe as default};
