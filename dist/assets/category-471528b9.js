import{e as T,h as F,i as N,j as $}from"./archive-d8d697d9.js";import{r as v,f as u,o as j,c as M,g as l,w as o,j as m,t as g,a as b,F as P,E as f,v as I}from"./index-24c808f8.js";import"./request-7e928fa4.js";const L=b("br",null,null,-1),G={class:"dialog-footer"},Q={__name:"category",setup(H){const i=v({total:0,query:{limit:20,page:1,order:null,name:null},data:[]}),y=n=>{i.value.query.page=n,s()},w=n=>{i.value.query.limit=n,s()},h=({column:n,prop:a,order:d})=>{let r="";d==="descending"?r="-":d==="ascending"&&(r="+"),i.value.query.order=r+a,s()},s=()=>{T(i.value.query).then(n=>{i.value.data=n.data,i.value.total=n.total})},_=v(null),e=v({visible:!1,title:"dialog",form:{},formRule:{name:[{required:!0,message:"名称",trigger:"blur"},{min:2,message:"用户名最少为2个字符",trigger:"blur"}]},formAction:"add"}),V=()=>{e.value.title="新增模板组",e.value.visible=!0,e.value.formAction="add",e.value.form={}},C=n=>{e.value.title="修改模板组",e.value.visible=!0,e.value.formAction="edit",e.value.form=n},k=()=>{_.value.validate(n=>{n?e.value.formAction==="add"?F(e.value.form).then(a=>{e.value.visible=!1,f.success(a),s()}):e.value.formAction==="edit"?(N(e.value.form).then(a=>{e.value.visible=!1,f.info(a),s()}),e.value.visible=!1):f.warning("提交错误"):f.error("请输入正确的数据！")})},x=n=>{I.confirm("请仔细确认是否删除 "+n.name+" ?","警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{$({id:n.id}).then(a=>{f.warning(a),s()})})};return s(),(n,a)=>{const d=u("el-button"),r=u("el-table-column"),A=u("el-link"),q=u("el-table"),D=u("el-pagination"),B=u("el-main"),c=u("el-input"),p=u("el-form-item"),S=u("el-switch"),U=u("el-input-number"),z=u("el-form"),E=u("el-dialog");return j(),M(P,null,[l(B,{style:{"background-color":"#fff"}},{default:o(()=>[l(d,{type:"primary",icon:"Plus",onClick:V},{default:o(()=>[m(" 新增 ")]),_:1}),l(q,{data:i.value.data,style:{width:"100%"},onSortChange:h},{default:o(()=>[l(r,{fixed:"",prop:"id",label:"ID",width:"80",sortable:"custom"}),l(r,{prop:"name",label:"名称",width:"140"}),l(r,{prop:"parent",label:"父级",width:"180"},{default:o(t=>[m(g(t.row.parent!=0?t.row.parent:"父级分类"),1)]),_:1}),l(r,{prop:"status",label:"状态",width:"180"},{default:o(t=>[l(A,{type:t.row.status>0?"success":"danger"},{default:o(()=>[m(g(t.row.status>0?t.row.status>1?t.row.status:"开启":"关闭"),1)]),_:2},1032,["type"])]),_:1}),l(r,{prop:"order",label:"排序",width:"180"}),l(r,{prop:"updatedAt",label:"最近更新",width:"200"}),l(r,{prop:"createdAt",label:"创建日期",width:"200"}),l(r,{fixed:"right",label:"操作",width:"120"},{default:o(t=>[l(d,{link:"",type:"primary",onClick:R=>C(t.row)},{default:o(()=>[m(" 编辑 ")]),_:2},1032,["onClick"]),l(d,{link:"",type:"danger",onClick:R=>x(t.row)},{default:o(()=>[m(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),L,l(D,{background:"",layout:"total, sizes, prev, pager, next",total:i.value.total,"page-size":i.value.query.limit,onCurrentChange:y,onSizeChange:w},null,8,["total","page-size"])]),_:1}),l(E,{modelValue:e.value.visible,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.visible=t),title:e.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:o(()=>[b("span",G,[l(d,{onClick:a[5]||(a[5]=t=>e.value.visible=!1)},{default:o(()=>[m("取消")]),_:1}),l(d,{type:"primary",onClick:k},{default:o(()=>[m("确定")]),_:1})])]),default:o(()=>[l(z,{ref_key:"dialogRef",ref:_,"label-position":"left",model:e.value.form,rules:e.value.formRule},{default:o(()=>[l(p,{label:"名称",prop:"name"},{default:o(()=>[l(c,{modelValue:e.value.form.name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.form.name=t)},null,8,["modelValue"])]),_:1}),l(p,{label:"状态"},{default:o(()=>[l(S,{modelValue:e.value.form.status,"onUpdate:modelValue":a[1]||(a[1]=t=>e.value.form.status=t),size:"large","active-text":"开启","inactive-text":"关闭","active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1}),l(p,{label:"父级",prop:"parent"},{default:o(()=>[l(U,{modelValue:e.value.form.parent,"onUpdate:modelValue":a[2]||(a[2]=t=>e.value.form.parent=t)},null,8,["modelValue"])]),_:1}),l(p,{label:"排序",prop:"order"},{default:o(()=>[l(c,{modelValue:e.value.form.order,"onUpdate:modelValue":a[3]||(a[3]=t=>e.value.form.order=t)},null,8,["modelValue"])]),_:1}),l(p,{label:"内容",prop:"content"},{default:o(()=>[l(c,{modelValue:e.value.form.content,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.form.content=t),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{Q as default};
