import{g as O,p as T}from"./wafcdn-13a6d1bd.js";import{r as g,f as n,o as p,c,g as e,w as a,j as s,t as D,a as $,F as b,s as h,E as y,v as j,h as U}from"./index-24c808f8.js";import"./request-7e928fa4.js";const z=$("br",null,null,-1),G={key:1},H={key:1},I={key:1},K={class:"dialog-footer"},Z={__name:"domain",setup(Q){const v=g({data:[]}),B=()=>{O().then(d=>{v.value.data=d})},x=g(null),l=g({visible:!1,title:"dialog",form:{},formTmp:{},formRule:{},formAction:"add"}),A=()=>{l.value.title="绑定新域名",l.value.visible=!0,l.value.formAction="add",l.value.form={},l.value.formTmp={domain:"",port:0,ssl:{port:0,crt:"",key:""},backend:{url:"",host:"",req_header:[],resp_header:[]},cache:{dir:"",rule:[]}}},S=d=>{l.value.title="修改 "+d.domain+" 的配置",l.value.visible=!0,l.value.formAction="edit",l.value.form=d,l.value.formTmp=JSON.parse(JSON.stringify(d)),l.value.formTmp.ssl.crt=atob(d.ssl.crt),l.value.formTmp.ssl.key=atob(d.ssl.key)},E=()=>{x.value.validate(d=>{if(d)if(l.value.formAction==="add")v.value.data.push(l.value.formTmp),T(v.value.data).then(t=>{l.value.visible=!1,y.info("新增完成")});else if(l.value.formAction==="edit"){l.value.formTmp.ssl.crt=btoa(l.value.formTmp.ssl.crt),l.value.formTmp.ssl.key=btoa(l.value.formTmp.ssl.key);for(const t in l.value.formTmp)l.value.form[t]=l.value.formTmp[t];T(v.value.data).then(t=>{l.value.visible=!1,y.info("修改完成")})}else y.error("提交错误");else y.error("请输入正确的数据！")})},N=d=>{j.confirm(`请仔细确认是否删除数据[${d}]?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{v.value.data.splice(d,1),T(v.value.data).then(t=>{l.value.visible=!1,y.info("删除完成")})})};return B(),(d,t)=>{const _=n("el-button"),V=n("el-table-column"),C=n("el-text"),w=n("el-link"),P=n("el-table"),R=n("el-main"),m=n("el-input"),i=n("el-form-item"),q=n("el-input-number"),k=n("el-tab-pane"),u=n("el-col"),F=n("el-row"),J=n("el-tabs"),L=n("el-form"),M=n("el-dialog");return p(),c(b,null,[e(R,{style:{"background-color":"#fff"}},{default:a(()=>[e(_,{type:"primary",icon:"Plus",onClick:A},{default:a(()=>[s(" 新增 ")]),_:1}),e(P,{data:v.value.data},{default:a(()=>[e(V,{label:"域名",prop:"domain",align:"center"}),e(V,{label:"端口(http)",prop:"port",align:"center"}),e(V,{label:"端口(https)",prop:"ssl.port",align:"center"}),e(V,{label:"源站",align:"center"},{default:a(o=>[e(C,{type:"info"},{default:a(()=>[s(" 回源地址: ")]),_:1}),s(),e(w,{type:"primary"},{default:a(()=>[s(D(o.row.backend.url),1)]),_:2},1024),s(),z,e(C,{type:"info"},{default:a(()=>[s(" 回源域名: ")]),_:1}),s(),e(w,{type:"warning"},{default:a(()=>[s(D(o.row.backend.host),1)]),_:2},1024)]),_:1}),e(V,{label:"缓存目录",prop:"cache.dir",align:"center"}),e(V,{fixed:"right",label:"操作",width:"105"},{default:a(o=>[e(_,{link:"",type:"primary",onClick:f=>S(o.row)},{default:a(()=>[s(" 编辑 ")]),_:2},1032,["onClick"]),e(_,{link:"",type:"danger",onClick:f=>N(o.$index)},{default:a(()=>[s(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(M,{modelValue:l.value.visible,"onUpdate:modelValue":t[12]||(t[12]=o=>l.value.visible=o),title:l.value.title,"close-on-click-modal":!1,"destroy-on-close":"","close-on-press-escape":"",center:""},{footer:a(()=>[$("span",K,[e(_,{onClick:t[11]||(t[11]=o=>l.value.visible=!1)},{default:a(()=>[s("取消")]),_:1}),e(_,{type:"primary",onClick:E},{default:a(()=>[s("确定")]),_:1})])]),default:a(()=>[e(L,{ref_key:"dialogRef",ref:x,"label-position":"left",model:l.value.formTmp,rules:l.value.formRule},{default:a(()=>[e(J,{type:"border-card"},{default:a(()=>[e(k,{label:"域名设置"},{default:a(()=>[e(i,{label:"域名",prop:"domain"},{default:a(()=>[e(m,{modelValue:l.value.formTmp.domain,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.formTmp.domain=o)},null,8,["modelValue"])]),_:1}),e(i,{label:"端口",prop:"port"},{default:a(()=>[e(q,{modelValue:l.value.formTmp.port,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.formTmp.port=o)},null,8,["modelValue"])]),_:1})]),_:1}),e(k,{label:"回源管理"},{default:a(()=>[e(i,{label:"回源路径",prop:"backend.url"},{default:a(()=>[e(m,{modelValue:l.value.formTmp.backend.url,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.formTmp.backend.url=o)},null,8,["modelValue"])]),_:1}),e(i,{label:"回源域名",prop:"backend.host"},{default:a(()=>[e(m,{modelValue:l.value.formTmp.backend.host,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.formTmp.backend.host=o)},null,8,["modelValue"])]),_:1}),e(i,{label:"回源请求头"},{default:a(()=>[(p(!0),c(b,null,h(l.value.formTmp.backend.req_header,(o,f)=>(p(),c(b,{key:f},[e(u,{span:11},{default:a(()=>[e(m,{modelValue:o.name,"onUpdate:modelValue":r=>o.name=r,placeholder:"名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:2,style:{"text-align":"center"}},{default:a(()=>[f==0?(p(),U(_,{key:0,type:"primary",icon:"Plus",circle:"",onClick:t[4]||(t[4]=r=>l.value.formTmp.backend.req_header.push({name:"",value:""}))})):(p(),c("span",G,"-"))]),_:2},1024),e(u,{span:11},{default:a(()=>[e(m,{modelValue:o.value,"onUpdate:modelValue":r=>o.value=r,placeholder:"值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:24,style:{height:"5px"}})],64))),128))]),_:1}),e(i,{label:"回源返回头"},{default:a(()=>[(p(!0),c(b,null,h(l.value.formTmp.backend.resp_header,(o,f)=>(p(),c(b,{key:f},[e(u,{span:11},{default:a(()=>[e(m,{modelValue:o.name,"onUpdate:modelValue":r=>o.name=r,placeholder:"名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:2,style:{"text-align":"center"}},{default:a(()=>[f==0?(p(),U(_,{key:0,type:"primary",icon:"Plus",circle:"",onClick:t[5]||(t[5]=r=>l.value.formTmp.backend.resp_header.push({name:"",value:""}))})):(p(),c("span",H,"-"))]),_:2},1024),e(u,{span:11},{default:a(()=>[e(m,{modelValue:o.value,"onUpdate:modelValue":r=>o.value=r,placeholder:"值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:24,style:{height:"5px"}})],64))),128))]),_:1})]),_:1}),e(k,{label:"SSL"},{default:a(()=>[e(i,{label:"回源路径",prop:"ssl.port"},{default:a(()=>[e(m,{modelValue:l.value.formTmp.ssl.port,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.formTmp.ssl.port=o)},null,8,["modelValue"])]),_:1}),e(F,null,{default:a(()=>[e(u,{span:11},{default:a(()=>[e(i,{label:"证书",prop:"ssl.crt"},{default:a(()=>[e(m,{modelValue:l.value.formTmp.ssl.crt,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.formTmp.ssl.crt=o),rows:"15",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:11},{default:a(()=>[e(i,{label:"密钥",prop:"ssl.key"},{default:a(()=>[e(m,{modelValue:l.value.formTmp.ssl.key,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.formTmp.ssl.key=o),rows:"15",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{label:"缓存配置"},{default:a(()=>[e(i,{label:"缓存路径",prop:"cache.dir"},{default:a(()=>[e(m,{modelValue:l.value.formTmp.cache.dir,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.formTmp.cache.dir=o)},null,8,["modelValue"])]),_:1}),e(i,{label:"缓存规则"},{default:a(()=>[(p(!0),c(b,null,h(l.value.formTmp.cache.rule,(o,f)=>(p(),c(b,{key:f},[e(u,{span:11},{default:a(()=>[e(m,{modelValue:o.path,"onUpdate:modelValue":r=>o.path=r,placeholder:"名"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:2,style:{"text-align":"center"}},{default:a(()=>[f==0?(p(),U(_,{key:0,type:"primary",icon:"Plus",circle:"",onClick:t[10]||(t[10]=r=>l.value.formTmp.backend.resp_header.push({path:"/example",time:1440}))})):(p(),c("span",I,"-"))]),_:2},1024),e(u,{span:11},{default:a(()=>[e(m,{modelValue:o.time,"onUpdate:modelValue":r=>o.time=r,placeholder:"值(分钟)"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(u,{span:24,style:{height:"5px"}})],64))),128))]),_:1})]),_:1}),e(k,{label:"安全配置"},{default:a(()=>[s(" 暂未开启 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}};export{Z as default};
