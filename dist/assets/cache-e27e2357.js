import{a as A,d as b}from"./wafcdn-13a6d1bd.js";import{f as H,d as k}from"./index-d3db0b60.js";import{r as C,f as r,o as _,c as I,a as q,g as e,w as t,j as c,h as g,q as h,t as v,n as y,F as P,v as w,E as x}from"./index-24c808f8.js";import"./request-7e928fa4.js";const Y=q("br",null,null,-1),K={__name:"cache",setup(j){const f=C(),z=()=>{l.value.data.forEach(a=>{f.value.toggleRowSelection(a)})},l=C({selectStat:!1,total:0,query:{limit:20,page:1,order:null,path:null},data:[]}),B=a=>{l.value.query.name=null,l.value.query.order=null,u()},F=a=>{l.value.query.page=a,u()},E=a=>{l.value.query.limit=a,u()},V=({column:a,prop:o,order:i})=>{let m="";i==="descending"?m="-":i==="ascending"&&(m="+"),l.value.query.order=m+o,u()},u=()=>{A(l.value.query).then(a=>{l.value.data=a.data,l.value.total=a.total})},D=a=>{w.confirm(`请仔细确认是否删除数据[${a.File}]?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{b({file:a.File}).then(o=>{x.warning(o),u()})})},R=()=>{const a=f.value.getSelectionRows();let o="";a.forEach(i=>{o!==""&&(o+=","),o+=i.File}),w.confirm(`请仔细确认是否删除 ${a.length} 条数据?`,"警告",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(()=>{b({file:o}).then(i=>{x.warning(i),u()})})};return u(),(a,o)=>{const i=r("el-input"),m=r("el-form-item"),s=r("el-button"),T=r("el-form"),d=r("el-table-column"),p=r("el-link"),S=r("el-tooltip"),N=r("el-table"),$=r("el-pagination"),M=r("el-main");return _(),I(P,null,[q("div",null,[e(T,{inline:!0},{default:t(()=>[e(m,{label:"路径"},{default:t(()=>[e(i,{modelValue:l.value.query.path,"onUpdate:modelValue":o[0]||(o[0]=n=>l.value.query.path=n),placeholder:"/url",clearable:""},null,8,["modelValue"])]),_:1}),e(m,null,{default:t(()=>[e(s,{type:"primary",icon:"search",onClick:u},{default:t(()=>[c(" 查询 ")]),_:1}),e(s,{type:"info",icon:"Refresh",onClick:B},{default:t(()=>[c(" 重置 ")]),_:1})]),_:1})]),_:1})]),e(M,{style:{"background-color":"#fff"}},{default:t(()=>[e(s,{type:"primary",size:"small",icon:l.value.selectStat?"SemiSelect":"Select",onClick:o[1]||(o[1]=n=>l.value.selectStat=!l.value.selectStat)},null,8,["icon"]),l.value.selectStat?(_(),g(s,{key:0,size:"small",onClick:z},{default:t(()=>[c(" 反选 ")]),_:1})):h("",!0),l.value.selectStat?(_(),g(s,{key:1,size:"small",onClick:f.value.clearSelection},{default:t(()=>[c(" 清空 ")]),_:1},8,["onClick"])):h("",!0),l.value.selectStat?(_(),g(s,{key:2,size:"small",type:"danger",onClick:R},{default:t(()=>[c(" 删除选中 ")]),_:1})):h("",!0),e(N,{ref_key:"tableRef",ref:f,data:l.value.data,onSortChange:V},{default:t(()=>[l.value.selectStat?(_(),g(d,{key:0,type:"selection",width:"50"})):h("",!0),e(d,{label:"站点",prop:"SiteID"}),e(d,{label:"路径",align:"center"},{default:t(n=>[e(S,{content:n.row.File,placement:"top"},{default:t(()=>[e(p,null,{default:t(()=>[c(v(n.row.Path),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),e(d,{label:"文件大小",align:"center"},{default:t(n=>[e(p,null,{default:t(()=>[c(v(y(H)(n.row.Size)),1)]),_:2},1024)]),_:1}),e(d,{label:"访问日期",align:"center"},{default:t(n=>[e(p,null,{default:t(()=>[c(v(y(k)("Y-m-d H:i:s",n.row.Accessed)),1)]),_:2},1024)]),_:1}),e(d,{label:"过期时间",align:"center"},{default:t(n=>[e(S,{content:"创建："+n.row.CreatedAt,placement:"top"},{default:t(()=>[e(p,null,{default:t(()=>[c(v(y(k)("Y-m-d H:i:s",n.row.Expried)),1)]),_:2},1024)]),_:2},1032,["content"])]),_:1}),e(d,{fixed:"right",label:"操作",width:"65"},{default:t(n=>[e(s,{link:"",type:"danger",onClick:L=>D(n.row)},{default:t(()=>[c(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Y,e($,{background:"",layout:"total, sizes, prev, pager, next",total:l.value.total,"page-size":l.value.query.limit,onCurrentChange:F,onSizeChange:E},null,8,["total","page-size"])]),_:1})],64)}}};export{K as default};
